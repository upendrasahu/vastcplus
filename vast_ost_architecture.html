<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vast Data OST Driver Architecture</title>
    <style>
        @media print {
            body { margin: 0; }
            .page-break { page-break-before: always; }
        }
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: white;
            color: #333;
        }
        .cover-page {
            text-align: center;
            padding: 100px 20px;
            border-bottom: 3px solid #2196F3;
        }
        .cover-title {
            font-size: 36px;
            font-weight: bold;
            color: #2196F3;
            margin-bottom: 20px;
        }
        .cover-subtitle {
            font-size: 24px;
            color: #666;
            margin-bottom: 40px;
        }
        .cover-info {
            font-size: 18px;
            color: #888;
            line-height: 1.6;
        }
        .diagram-page {
            margin: 40px 0;
            padding: 20px;
        }
        h1 {
            color: #2196F3;
            border-bottom: 3px solid #2196F3;
            padding-bottom: 10px;
            font-size: 28px;
        }
        h2 {
            color: #333;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 8px;
            font-size: 22px;
            margin-top: 40px;
        }
        h3 {
            color: #666;
            font-size: 18px;
            margin-top: 30px;
        }
        .svg-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
            background: white;
        }
        .requirements-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .requirements-box {
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid;
        }
        .management-apis {
            background: #f0f8ff;
            border-left-color: #2196F3;
        }
        .data-apis {
            background: #f1f8e9;
            border-left-color: #4CAF50;
        }
        .performance-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .perf-box {
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid;
        }
        .throughput { background: #fff3e0; border-left-color: #FF9800; }
        .latency { background: #fce4ec; border-left-color: #E91E63; }
        .scalability { background: #f3e5f5; border-left-color: #9C27B0; }
        ul {
            padding-left: 20px;
        }
        li {
            margin: 8px 0;
        }
        .success-criteria {
            background: #fff3e0;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .deliverables-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .deliverable-box {
            padding: 15px;
            border-radius: 8px;
        }
        .technical-deliverables { background: #f0f8ff; }
        .documentation-deliverables { background: #f1f8e9; }
    </style>
</head>
<body>
    <!-- Cover Page -->
    <div class="cover-page">
        <div class="cover-title">Vast Data OST Driver</div>
        <div class="cover-subtitle">Architecture & Implementation Plan</div>
        <div class="cover-info">
            <p>NetBackup OpenStorage Technology Integration</p>
            <p>Technical Architecture Document</p>
            <p style="margin-top: 40px; font-size: 16px;">
                Enabling enterprise-grade backup integration<br>
                between NetBackup and Vast Data storage systems
            </p>
        </div>
    </div>

    <div class="page-break"></div>

    <!-- Architecture Overview -->
    <div class="diagram-page">
        <h1>1. High-Level OST Driver Architecture</h1>
        <div class="svg-container">
            <svg width="800" height="600" viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
                <!-- NetBackup Environment -->
                <rect x="50" y="50" width="700" height="250" fill="#E6F3FF" stroke="#2196F3" stroke-width="2" rx="10"/>
                <text x="375" y="75" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold">NetBackup Environment</text>
                
                <!-- Master Server -->
                <rect x="80" y="100" width="120" height="80" fill="#BBDEFB" stroke="#1976D2" stroke-width="1" rx="5"/>
                <text x="140" y="120" text-anchor="middle" font-family="Arial" font-size="12" font-weight="bold">Master Server</text>
                <text x="140" y="135" text-anchor="middle" font-family="Arial" font-size="10">• Policy Management</text>
                <text x="140" y="148" text-anchor="middle" font-family="Arial" font-size="10">• Job Scheduling</text>
                <text x="140" y="161" text-anchor="middle" font-family="Arial" font-size="10">• Catalog Database</text>
                <text x="140" y="174" text-anchor="middle" font-family="Arial" font-size="10">• Admin Console</text>
                
                <!-- Arrow from Master to Media Servers -->
                <path d="M 200 140 L 250 140" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
                
                <!-- Media Servers -->
                <rect x="280" y="100" width="450" height="180" fill="#C8E6C9" stroke="#388E3C" stroke-width="1" rx="5"/>
                <text x="505" y="120" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">Media Servers</text>
                
                <!-- Media Server 1 -->
                <rect x="300" y="135" width="180" height="60" fill="#E8F5E8" stroke="#4CAF50" stroke-width="1" rx="3"/>
                <text x="390" y="150" text-anchor="middle" font-family="Arial" font-size="11" font-weight="bold">Media Server 1</text>
                <rect x="320" y="155" width="140" height="25" fill="#81C784" stroke="#4CAF50" stroke-width="1" rx="3"/>
                <text x="390" y="170" text-anchor="middle" font-family="Arial" font-size="10" fill="white">Vast Data OST Driver</text>
                
                <!-- Media Server 2 -->
                <rect x="500" y="135" width="180" height="60" fill="#E8F5E8" stroke="#4CAF50" stroke-width="1" rx="3"/>
                <text x="590" y="150" text-anchor="middle" font-family="Arial" font-size="11" font-weight="bold">Media Server 2</text>
                <rect x="520" y="155" width="140" height="25" fill="#81C784" stroke="#4CAF50" stroke-width="1" rx="3"/>
                <text x="590" y="170" text-anchor="middle" font-family="Arial" font-size="10" fill="white">Vast Data OST Driver</text>
                
                <!-- Client Agents -->
                <rect x="280" y="210" width="450" height="50" fill="#FFF3E0" stroke="#FF9800" stroke-width="1" rx="5"/>
                <text x="505" y="230" text-anchor="middle" font-family="Arial" font-size="12" font-weight="bold">Client Agents</text>
                <text x="505" y="245" text-anchor="middle" font-family="Arial" font-size="10">(on backup targets)</text>
                
                <!-- Network -->
                <rect x="350" y="320" width="100" height="30" fill="#FFECB3" stroke="#FFA000" stroke-width="1" rx="15"/>
                <text x="400" y="340" text-anchor="middle" font-family="Arial" font-size="12">Network</text>
                
                <!-- Connection arrows -->
                <path d="M 400 280 L 400 320" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
                <path d="M 400 350 L 400 380" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
                
                <!-- Vast Data Cluster -->
                <rect x="50" y="380" width="700" height="170" fill="#F3E5F5" stroke="#9C27B0" stroke-width="2" rx="10"/>
                <text x="400" y="405" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold">Vast Data Cluster</text>
                
                <!-- Nodes -->
                <rect x="100" y="430" width="80" height="60" fill="#E1BEE7" stroke="#8E24AA" stroke-width="1" rx="5"/>
                <text x="140" y="450" text-anchor="middle" font-family="Arial" font-size="11" font-weight="bold">Node 1</text>
                
                <rect x="200" y="430" width="80" height="60" fill="#E1BEE7" stroke="#8E24AA" stroke-width="1" rx="5"/>
                <text x="240" y="450" text-anchor="middle" font-family="Arial" font-size="11" font-weight="bold">Node 2</text>
                
                <text x="320" y="460" text-anchor="middle" font-family="Arial" font-size="14">...</text>
                
                <rect x="360" y="430" width="80" height="60" fill="#E1BEE7" stroke="#8E24AA" stroke-width="1" rx="5"/>
                <text x="400" y="450" text-anchor="middle" font-family="Arial" font-size="11" font-weight="bold">Node N</text>
                
                <!-- Vast Data APIs -->
                <rect x="100" y="510" width="550" height="30" fill="#CE93D8" stroke="#8E24AA" stroke-width="1" rx="5"/>
                <text x="375" y="530" text-anchor="middle" font-family="Arial" font-size="12" font-weight="bold">Vast Data REST APIs (Management &amp; Data)</text>
                
                <!-- Arrow marker definition -->
                <defs>
                    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="#333"/>
                    </marker>
                </defs>
            </svg>
        </div>
        
        <h3>Key Architecture Components:</h3>
        <ul>
            <li><strong>Master Server:</strong> Single management point with NetBackup console</li>
            <li><strong>Media Servers:</strong> Multiple workers running OST drivers</li>
            <li><strong>OST Driver:</strong> Translation layer between NetBackup and Vast Data</li>
            <li><strong>Vast Data Cluster:</strong> Scale-out storage with REST API access</li>
        </ul>
    </div>

    <div class="page-break"></div>

    <!-- Internal Architecture -->
    <div class="diagram-page">
        <h1>2. Detailed OST Driver Internal Architecture</h1>
        <div class="svg-container">
            <svg width="600" height="700" viewBox="0 0 600 700" xmlns="http://www.w3.org/2000/svg">
                <!-- OST Driver Container -->
                <rect x="50" y="50" width="500" height="600" fill="#E8F5E8" stroke="#4CAF50" stroke-width="3" rx="10"/>
                <text x="300" y="75" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold">Vast Data OST Driver</text>
                
                <!-- OST API Layer -->
                <rect x="80" y="100" width="440" height="80" fill="#BBDEFB" stroke="#2196F3" stroke-width="2" rx="5"/>
                <text x="300" y="120" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">OST API Layer</text>
                
                <rect x="100" y="130" width="90" height="35" fill="#90CAF9" stroke="#1976D2" stroke-width="1" rx="3"/>
                <text x="145" y="145" text-anchor="middle" font-family="Arial" font-size="9">stsp_init</text>
                <text x="145" y="157" text-anchor="middle" font-family="Arial" font-size="9">stsp_terminate</text>
                
                <rect x="210" y="130" width="90" height="35" fill="#90CAF9" stroke="#1976D2" stroke-width="1" rx="3"/>
                <text x="255" y="148" text-anchor="middle" font-family="Arial" font-size="9">stsp_claim</text>
                
                <rect x="320" y="130" width="90" height="35" fill="#90CAF9" stroke="#1976D2" stroke-width="1" rx="3"/>
                <text x="365" y="145" text-anchor="middle" font-family="Arial" font-size="9">stsp_open_</text>
                <text x="365" y="157" text-anchor="middle" font-family="Arial" font-size="9">server</text>
                
                <text x="440" y="148" text-anchor="middle" font-family="Arial" font-size="12">...</text>
                
                <!-- Arrow -->
                <path d="M 300 180 L 300 200" stroke="#333" stroke-width="2" marker-end="url(#arrowhead2)"/>
                
                <!-- OST Operation Handlers -->
                <rect x="80" y="200" width="440" height="80" fill="#C8E6C9" stroke="#388E3C" stroke-width="2" rx="5"/>
                <text x="300" y="220" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">OST Operation Handlers</text>
                
                <rect x="100" y="235" width="110" height="35" fill="#A5D6A7" stroke="#4CAF50" stroke-width="1" rx="3"/>
                <text x="155" y="250" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold">Server</text>
                <text x="155" y="262" text-anchor="middle" font-family="Arial" font-size="10">Operations</text>
                
                <rect x="245" y="235" width="110" height="35" fill="#A5D6A7" stroke="#4CAF50" stroke-width="1" rx="3"/>
                <text x="300" y="250" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold">LSU</text>
                <text x="300" y="262" text-anchor="middle" font-family="Arial" font-size="10">Operations</text>
                
                <rect x="390" y="235" width="110" height="35" fill="#A5D6A7" stroke="#4CAF50" stroke-width="1" rx="3"/>
                <text x="445" y="250" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold">Image</text>
                <text x="445" y="262" text-anchor="middle" font-family="Arial" font-size="10">Operations</text>
                
                <!-- Arrow -->
                <path d="M 300 280 L 300 300" stroke="#333" stroke-width="2" marker-end="url(#arrowhead2)"/>
                
                <!-- Multi-Threading Layer -->
                <rect x="80" y="300" width="440" height="80" fill="#FFF3E0" stroke="#FF9800" stroke-width="2" rx="5"/>
                <text x="300" y="320" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">Multi-Threading Layer</text>
                
                <rect x="100" y="335" width="110" height="35" fill="#FFCC80" stroke="#F57C00" stroke-width="1" rx="3"/>
                <text x="155" y="350" text-anchor="middle" font-family="Arial" font-size="10">Thread Pool</text>
                <text x="155" y="362" text-anchor="middle" font-family="Arial" font-size="10">Manager</text>
                
                <rect x="245" y="335" width="110" height="35" fill="#FFCC80" stroke="#F57C00" stroke-width="1" rx="3"/>
                <text x="300" y="350" text-anchor="middle" font-family="Arial" font-size="10">Connection</text>
                <text x="300" y="362" text-anchor="middle" font-family="Arial" font-size="10">Pool Manager</text>
                
                <rect x="390" y="335" width="110" height="35" fill="#FFCC80" stroke="#F57C00" stroke-width="1" rx="3"/>
                <text x="445" y="350" text-anchor="middle" font-family="Arial" font-size="10">Async I/O</text>
                <text x="445" y="362" text-anchor="middle" font-family="Arial" font-size="10">Manager</text>
                
                <!-- Arrow -->
                <path d="M 300 380 L 300 400" stroke="#333" stroke-width="2" marker-end="url(#arrowhead2)"/>
                
                <!-- Vast Data Client Library -->
                <rect x="80" y="400" width="440" height="80" fill="#F3E5F5" stroke="#9C27B0" stroke-width="2" rx="5"/>
                <text x="300" y="420" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">Vast Data Client Library</text>
                
                <rect x="100" y="435" width="110" height="35" fill="#E1BEE7" stroke="#8E24AA" stroke-width="1" rx="3"/>
                <text x="155" y="450" text-anchor="middle" font-family="Arial" font-size="10">Management</text>
                <text x="155" y="462" text-anchor="middle" font-family="Arial" font-size="10">Client</text>
                
                <rect x="245" y="435" width="110" height="35" fill="#E1BEE7" stroke="#8E24AA" stroke-width="1" rx="3"/>
                <text x="300" y="450" text-anchor="middle" font-family="Arial" font-size="10">Data I/O</text>
                <text x="300" y="462" text-anchor="middle" font-family="Arial" font-size="10">Client</text>
                
                <rect x="390" y="435" width="110" height="35" fill="#E1BEE7" stroke="#8E24AA" stroke-width="1" rx="3"/>
                <text x="445" y="450" text-anchor="middle" font-family="Arial" font-size="10">Error</text>
                <text x="445" y="462" text-anchor="middle" font-family="Arial" font-size="10">Handler</text>
                
                <!-- Arrow -->
                <path d="M 300 480 L 300 500" stroke="#333" stroke-width="2" marker-end="url(#arrowhead2)"/>
                
                <!-- REST API & Network Layer -->
                <rect x="80" y="500" width="440" height="80" fill="#FFEBEE" stroke="#F44336" stroke-width="2" rx="5"/>
                <text x="300" y="520" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">REST API &amp; Network Layer</text>
                
                <rect x="130" y="535" width="120" height="35" fill="#FFCDD2" stroke="#D32F2F" stroke-width="1" rx="3"/>
                <text x="190" y="550" text-anchor="middle" font-family="Arial" font-size="10">HTTP/REST</text>
                <text x="190" y="562" text-anchor="middle" font-family="Arial" font-size="10">Client</text>
                
                <rect x="270" y="535" width="120" height="35" fill="#FFCDD2" stroke="#D32F2F" stroke-width="1" rx="3"/>
                <text x="330" y="550" text-anchor="middle" font-family="Arial" font-size="10">JSON</text>
                <text x="330" y="562" text-anchor="middle" font-family="Arial" font-size="10">Parser</text>
                
                <rect x="410" y="535" width="120" height="35" fill="#FFCDD2" stroke="#D32F2F" stroke-width="1" rx="3"/>
                <text x="470" y="550" text-anchor="middle" font-family="Arial" font-size="10">TLS/SSL</text>
                <text x="470" y="562" text-anchor="middle" font-family="Arial" font-size="10">Security</text>
                
                <!-- Arrow -->
                <path d="M 300 580 L 300 600" stroke="#333" stroke-width="2" marker-end="url(#arrowhead2)"/>
                
                <!-- Network Connection -->
                <rect x="250" y="600" width="100" height="30" fill="#FFECB3" stroke="#FFA000" stroke-width="1" rx="15"/>
                <text x="300" y="620" text-anchor="middle" font-family="Arial" font-size="12">Network</text>
                
                <!-- Arrow marker definition -->
                <defs>
                    <marker id="arrowhead2" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="#333"/>
                    </marker>
                </defs>
            </svg>
        </div>
        
        <h3>OST Threading Model:</h3>
        <div style="background: #f1f8e9; padding: 15px; border-radius: 8px; border-left: 4px solid #4CAF50; margin: 20px 0;">
            <h4 style="margin-top: 0; color: #388E3C;">OST Handle Requirements:</h4>
            <ul style="margin: 10px 0;">
                <li><strong>Single-Threaded Handles:</strong> Each OST handle (server, image, LSU) can only be accessed by the thread that created it</li>
                <li><strong>No Handle Sharing:</strong> Handles cannot be shared between threads - each thread creates its own handles</li>
                <li><strong>Plugin Versions:</strong> Must build both single-threaded (.so) and multithreaded (MT.dll/.so) versions</li>
                <li><strong>Internal Thread Safety:</strong> Plugin internal implementation must be thread-safe using synchronization primitives</li>
                <li><strong>Concurrency Model:</strong> NetBackup creates multiple threads, each with dedicated handle sets</li>
            </ul>
        </div>
        
        <h3>Architecture Understanding:</h3>
        <ul>
            <li><strong>NetBackup Core Library:</strong> Manages multiple threads, each with its own set of handles</li>
            <li><strong>OST Driver Interface:</strong> Provides single-threaded handles as per OST specification</li>
            <li><strong>Internal Implementation:</strong> Can use thread-safe shared resources (connection pools, etc.)</li>
            <li><strong>Concurrency Model:</strong> Multiple threads each with dedicated handles, not shared handles</li>
        </ul>
    </div>

    <div class="page-break"></div>

    <!-- Integration Requirements -->
    <div class="diagram-page">
        <h1>3. Key Integration Points with Vast Data</h1>
        
        <h2>Required Vast Data REST APIs</h2>
        <div class="requirements-grid">
            <div class="requirements-box management-apis">
                <h3 style="margin-top: 0; color: #1976D2;">Management REST APIs</h3>
                <ul>
                    <li>Volume/Namespace creation and management</li>
                    <li>User authentication and authorization</li>
                    <li>Quota and capacity management</li>
                    <li>Performance monitoring and statistics</li>
                    <li>Cluster health and status reporting</li>
                </ul>
            </div>
            <div class="requirements-box data-apis">
                <h3 style="margin-top: 0; color: #388E3C;">Data REST APIs</h3>
                <ul>
                    <li>High-performance file I/O via REST</li>
                    <li>Directory and metadata operations</li>
                    <li>Atomic file operations (create, write, close)</li>
                    <li>File deletion and cleanup</li>
                    <li>Snapshot and versioning APIs</li>
                </ul>
            </div>
        </div>
        
        <h2>Performance Requirements</h2>
        <div class="performance-grid">
            <div class="perf-box throughput">
                <h3 style="margin-top: 0; color: #F57C00;">Throughput Targets</h3>
                <ul>
                    <li><strong>Single stream:</strong> Maximize per-stream throughput</li>
                    <li><strong>Multiple streams:</strong> Scale linearly with stream count</li>
                    <li><strong>Concurrent jobs:</strong> Support enterprise-scale concurrent backups</li>
                </ul>
            </div>
            <div class="perf-box latency">
                <h3 style="margin-top: 0; color: #C2185B;">Latency Targets</h3>
                <ul>
                    <li><strong>File operations:</strong> Minimize API call latency</li>
                    <li><strong>First byte:</strong> Optimize connection establishment</li>
                    <li><strong>File completion:</strong> Efficient commit operations</li>
                </ul>
            </div>
            <div class="perf-box scalability">
                <h3 style="margin-top: 0; color: #7B1FA2;">Scalability</h3>
                <ul>
                    <li><strong>Media Servers:</strong> Support multiple concurrent servers</li>
                    <li><strong>Connections:</strong> Efficient connection pooling</li>
                    <li><strong>Storage capacity:</strong> Scale with Vast Data cluster</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="page-break"></div>

    <!-- Success Metrics -->
    <div class="diagram-page">
        <h1>4. Success Metrics & Deliverables</h1>
        
        <div class="deliverables-grid">
            <div class="deliverable-box technical-deliverables">
                <h3 style="color: #2196F3;">Technical Deliverables</h3>
                <ul>
                    <li>✓ Complete OST driver (.so/.dll files)</li>
                    <li>✓ Source code with comprehensive documentation</li>
                    <li>✓ Unit and integration test suites</li>
                    <li>✓ Performance benchmarking tools</li>
                    <li>✓ NetBackup certification results</li>
                </ul>
            </div>
            <div class="deliverable-box documentation-deliverables">
                <h3 style="color: #4CAF50;">Documentation</h3>
                <ul>
                    <li>✓ Installation and configuration guide</li>
                    <li>✓ Administrator's reference manual</li>
                    <li>✓ Troubleshooting and support guide</li>
                    <li>✓ Performance tuning recommendations</li>
                    <li>✓ Integration architecture documentation</li>
                </ul>
            </div>
        </div>
        
        <h2>Success Criteria</h2>
        <div class="success-criteria">
            <ul style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; list-style: none; padding: 0; margin: 0;">
                <li>✓ Pass NetBackup OST certification</li>
                <li>✓ Achieve target performance benchmarks</li>
                <li>✓ Support enterprise-scale deployments</li>
                <li>✓ 99.9%+ backup job success rate</li>
                <li>✓ Successful customer pilot deployments</li>
                <li>✓ Seamless NetBackup admin experience</li>
            </ul>
        </div>

        <h2>Key Benefits</h2>
        <ul>
            <li><strong>Native Integration:</strong> Deep NetBackup integration vs generic protocols</li>
            <li><strong>High Performance:</strong> Multi-stream support for enterprise throughput</li> 
            <li><strong>Scalability:</strong> Support for multiple Media Servers and concurrent operations</li>
            <li><strong>Enterprise Features:</strong> Advanced backup operations like image duplication</li>
            <li><strong>Simplified Management:</strong> Single NetBackup interface for all operations</li>
        </ul>
    </div>

</body>
</html>